---
phase: 06-polish-quality-assurance
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/styles/variants/parallax.ts
  - src/styles/variants/micro-interactions.ts
  - src/styles/variants/index.ts
  - src/lib/hooks/useScrollProgress.ts
  - src/components/shared/Parallax/Parallax.tsx
  - src/components/shared/Button/Button.tsx
  - src/components/shared/Card/Card.tsx
  - src/components/marketing/MarketingNav.tsx
  - src/app/(marketing)/page.tsx
  - src/app/(b2c)/briefing/page.tsx
  - src/app/(b2c)/intelligence/page.tsx
  - src/app/(b2c)/journeys/page.tsx
autonomous: true

must_haves:
  truths:
    - "Page transitions animate smoothly with Framer Motion across B2C, B2B, and Admin route groups"
    - "Parallax scroll effects work on marketing homepage hero and section 4 cinematic break"
    - "B2C narrative pages (briefing, intelligence, journeys) have scroll-reveal entrance animations"
    - "All CTAs have triple-state micro-interactions: hover (scale 1.02), tap (scale 0.97), and loading (opacity 0.6)"
    - "Reduced-motion users see no animations — all motion respects prefers-reduced-motion"
    - "Marketing nav glassmorphism transition animates smoothly on scroll"
  artifacts:
    - path: "src/styles/variants/parallax.ts"
      provides: "Parallax animation configuration variants"
      contains: "heroParallax"
    - path: "src/lib/hooks/useScrollProgress.ts"
      provides: "Reusable scroll progress hook for parallax and scroll-linked effects"
      exports: ["useScrollProgress"]
    - path: "src/styles/variants/micro-interactions.ts"
      provides: "Enhanced micro-interaction variants with loading state"
      contains: "loadingPulse"
  key_links:
    - from: "src/components/shared/Button/Button.tsx"
      to: "src/styles/variants/micro-interactions.ts"
      via: "Framer Motion whileHover/whileTap"
      pattern: "whileHover|whileTap|buttonHover|buttonTap"
    - from: "src/app/(marketing)/page.tsx"
      to: "src/styles/variants/parallax.ts"
      via: "useScroll/useTransform for hero parallax"
      pattern: "useScroll|useTransform|heroParallax"
---

<objective>
Enhance motion design across all route groups with cinematic page transitions, parallax scroll effects, micro-interactions on all CTAs, and comprehensive reduced-motion support.

Purpose: Achieve Dribbble-level animation polish that makes the platform feel like a luxury experience, not software. Motion design is the difference between "functional" and "cinematic."

Output: Enhanced animation variants, scroll-linked parallax hook, micro-interaction-enabled Button/Card components, polished marketing homepage, and scroll-reveal B2C narrative pages. All respecting prefers-reduced-motion.
</objective>

<execution_context>
@/Users/kavi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/kavi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-polish-quality-assurance/06-RESEARCH.md

# Existing animation infrastructure
@src/styles/variants/page-transitions.ts
@src/styles/variants/micro-interactions.ts
@src/styles/variants/scroll-reveal.ts
@src/styles/variants/index.ts
@src/lib/hooks/useReducedMotion.ts
@src/components/providers/PageTransition.tsx
@src/components/shared/Parallax/Parallax.tsx
@src/components/shared/ScrollReveal/ScrollReveal.tsx
@src/components/shared/Button/Button.tsx
@src/components/shared/Card/Card.tsx

# Pages to enhance with motion
@src/app/(marketing)/page.tsx
@src/app/(marketing)/layout.tsx
@src/components/marketing/MarketingNav.tsx
@src/app/(b2c)/layout.tsx
@src/app/(b2c)/briefing/page.tsx
@src/app/(b2c)/intelligence/page.tsx
@src/app/(b2c)/journeys/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create parallax variants, useScrollProgress hook, and enhance micro-interactions</name>
  <files>
    src/styles/variants/parallax.ts
    src/styles/variants/micro-interactions.ts
    src/styles/variants/index.ts
    src/lib/hooks/useScrollProgress.ts
  </files>
  <action>
  1. Create `src/styles/variants/parallax.ts` with parallax configuration presets:
     - `heroParallax`: { textY: [0, -100], textOpacity: [1, 0.5, 0], bgY: [0, -200] } — for hero section text and background movement
     - `cinematicBreak`: { contentY: [0, -50], contentOpacity: [0.8, 1, 0.8] } — for dark cinematic sections
     - `sectionReveal`: { y: [100, 0], opacity: [0, 1] } — for scroll-into-view sections
     These are configuration objects (not Framer Motion variants) that store transform ranges for useScroll/useTransform usage.

  2. Create `src/lib/hooks/useScrollProgress.ts`:
     - Export `useScrollProgress(ref, options?)` hook that wraps Framer Motion's `useScroll` with `useTransform`
     - Accept a ref, optional scroll offset (default: `['start end', 'end start']`)
     - Return `{ scrollYProgress, y, opacity }` pre-computed transforms
     - This provides a reusable pattern so parallax users don't need to manually call useScroll+useTransform
     - Import and respect `useReducedMotion` — if reduced motion, return static values (no transforms)

  3. Enhance `src/styles/variants/micro-interactions.ts`:
     - Keep existing buttonTap, buttonHover, cardHover, pulseOnce, shimmer
     - Add `loadingPulse`: { opacity: [0.6, 1, 0.6], transition: { duration: 1.5, repeat: Infinity, ease: 'easeInOut' } }
     - Add `linkHover`: { x: 4, transition: { duration: 0.2 } } — subtle rightward nudge for text links
     - Add `cardLift`: { y: -6, boxShadow: '0 20px 40px rgba(0,0,0,0.08)', transition: { duration: 0.3, ease: [0.4, 0, 0.2, 1] } } — luxury card elevation on hover
     - Add `navScrollTransition`: { backdropBlur: 16, backgroundColor: 'rgba(255,255,255,0.9)' } — config for nav glassmorphism (used as reference values, not Framer variants)

  4. Update `src/styles/variants/index.ts` to re-export new parallax variants and additional micro-interactions (heroParallax, cinematicBreak, sectionReveal, loadingPulse, linkHover, cardLift).
  </action>
  <verify>
  - `npx tsc --noEmit` passes with no type errors
  - All new exports accessible: `import { heroParallax, useScrollProgress, loadingPulse } from` respective modules
  </verify>
  <done>
  Parallax configuration variants exist with hero, cinematic, and section presets. useScrollProgress hook provides reusable scroll-linked transforms with reduced-motion support. Micro-interactions include loading, link hover, and card lift states.
  </done>
</task>

<task type="auto">
  <name>Task 2: Enhance Button and Card with Framer Motion micro-interactions</name>
  <files>
    src/components/shared/Button/Button.tsx
    src/components/shared/Card/Card.tsx
  </files>
  <action>
  1. Enhance `src/components/shared/Button/Button.tsx`:
     - Import `motion` from framer-motion, `useReducedMotion` from hooks, `buttonHover`, `buttonTap`, `loadingPulse` from micro-interactions
     - Convert the `<button>` to `motion.button` via `motion.create` or direct `motion.button`
     - Add `whileHover={prefersReducedMotion ? undefined : buttonHover}` on non-disabled, non-loading state
     - Add `whileTap={prefersReducedMotion ? undefined : buttonTap}` on non-disabled, non-loading state
     - Add `animate` prop: when `loading` prop is true, apply loadingPulse animation
     - Add `loading?: boolean` prop and `aria-busy={loading}` attribute
     - When loading, show a spinner (use a simple animated div or existing pattern) and disable click
     - Ensure `min-h-[44px] min-w-[44px]` for touch target compliance (44x44px minimum)
     - Keep forwardRef pattern, keep existing variant/size system, keep cn() utility
     - Mark component as 'use client' since it uses hooks

  2. Enhance `src/components/shared/Card/Card.tsx`:
     - Read the existing Card component first to understand its current structure
     - Import `motion` from framer-motion, `useReducedMotion` from hooks, `cardLift` from micro-interactions
     - Add optional `interactive?: boolean` prop (default false)
     - When `interactive=true`, wrap card content with `motion.div` and add `whileHover={prefersReducedMotion ? undefined : cardLift}`
     - Ensure non-interactive cards remain pure `<div>` with no motion overhead
     - Add `role="article"` for interactive cards for accessibility
     - Keep existing styling, className merge pattern, and any existing variants
  </action>
  <verify>
  - `npx tsc --noEmit` passes
  - `npm run build` completes without errors
  - Import `Button` with `loading` prop type-checks
  - Import `Card` with `interactive` prop type-checks
  </verify>
  <done>
  Button has hover scale (1.02), tap scale (0.97), and loading pulse animation with aria-busy. Card has optional lift-on-hover for interactive cards. Both respect prefers-reduced-motion. Touch targets are 44x44px minimum.
  </done>
</task>

<task type="auto">
  <name>Task 3: Polish marketing homepage parallax, B2C narrative scroll-reveals, and nav transitions</name>
  <files>
    src/app/(marketing)/page.tsx
    src/components/marketing/MarketingNav.tsx
    src/app/(b2c)/briefing/page.tsx
    src/app/(b2c)/intelligence/page.tsx
    src/app/(b2c)/journeys/page.tsx
  </files>
  <action>
  1. Enhance `src/app/(marketing)/page.tsx`:
     - The homepage already has parallax on hero and ScrollReveal on sections — enhance, don't rebuild
     - Import `heroParallax` from parallax variants for configuration reference
     - Add multi-layer parallax to hero: background gradient layer moves at 0.3x speed, text moves at 0.5x speed (already partially done — refine offsets using heroParallax config values for consistency)
     - Enhance Section 4 "By invitation only" cinematic break: add opacity fade-in as user scrolls into section using `cinematicBreak` config, make the dark section feel more immersive
     - Add subtle `fadeIn` scroll-reveal to Section 5 right-column visual placeholder
     - Ensure all Framer Motion usage checks `prefersReducedMotion` (existing code already does this — verify no gaps)

  2. Enhance `src/components/marketing/MarketingNav.tsx`:
     - Read the existing nav first to understand current scroll behavior
     - If not already animated, add smooth opacity/backdrop-blur transition on scroll:
       - At scroll position 0: fully transparent background, no backdrop blur
       - At scroll position > 50px: white/90% opacity, backdrop-blur-xl, subtle bottom border
       - Use `useScroll` + `useTransform` for smooth interpolation (NOT binary toggle with useState)
       - Apply `motion.nav` with `style={{ backgroundColor, backdropFilter }}` driven by scroll transforms
     - Respect prefers-reduced-motion: if reduced, show static solid nav

  3. Add `ScrollReveal` wrappers to B2C narrative pages for entrance animations:
     - `src/app/(b2c)/briefing/page.tsx`: Wrap main sections with `<ScrollReveal variant={fadeUp}>` for staggered reveal of briefing cards (emotional phase, journey preview, etc.)
     - `src/app/(b2c)/intelligence/page.tsx`: Wrap intelligence brief sections with scroll reveals for magazine-style content entrance
     - `src/app/(b2c)/journeys/page.tsx`: Wrap journey cards with scroll reveals using `staggerChildren` parent + `fadeUp` children for sequential card entrance
     - For each page: Read the existing content first, then add ScrollReveal wrappers around logical content sections. Do NOT restructure the existing content — only wrap with animation components.
     - Import ScrollReveal and fadeUp/fadeIn/staggerChildren from existing exports
     - All scroll reveals should use `once={true}` (default) so they only animate on first view
  </action>
  <verify>
  - `npm run build` completes successfully
  - No TypeScript errors
  - Marketing homepage: hero parallax layers move at different speeds on scroll, section 4 fades in cinematically, all sections scroll-reveal on first view
  - B2C pages: content sections animate in on scroll with fadeUp effect
  - Marketing nav: transitions from transparent to glassmorphism smoothly
  - All animations disabled when prefers-reduced-motion is set
  </verify>
  <done>
  Marketing homepage has refined multi-layer parallax hero and cinematic break section. Marketing nav smoothly transitions from transparent to glassmorphism on scroll. B2C briefing, intelligence, and journeys pages have scroll-reveal entrance animations on content sections. All animations respect reduced-motion preference.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` — no type errors across all modified files
2. `npm run build` — production build succeeds
3. Visual check: Marketing homepage parallax creates depth with layers moving at different speeds
4. Visual check: Marketing nav transitions smoothly from transparent to solid on scroll
5. Visual check: B2C pages have content that animates in on first scroll
6. Visual check: Button hover shows subtle scale, tap shows press feedback, loading shows pulse
7. Accessibility: Set `prefers-reduced-motion: reduce` in browser — all animations should be disabled
</verification>

<success_criteria>
- Page transitions work across all 3 route groups (B2C, B2B, Admin) via existing PageTransition — already working, no regression
- Parallax scroll on marketing homepage hero and section 4 creates cinematic depth
- All interactive elements (Button, Card, nav links) have hover/tap/loading micro-interactions
- B2C narrative pages have scroll-triggered entrance animations
- Marketing nav glassmorphism transition is scroll-linked (not binary toggle)
- Zero motion when prefers-reduced-motion is set
- Build passes with no errors
</success_criteria>

<output>
After completion, create `.planning/phases/06-polish-quality-assurance/06-01-SUMMARY.md`
</output>
