---
phase: 02-marketing-authentication
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/(marketing)/layout.tsx
  - src/components/marketing/MarketingNav.tsx
  - src/components/marketing/MarketingFooter.tsx
  - src/app/(marketing)/invite/page.tsx
  - src/app/api/invite/validate/route.ts
autonomous: true

must_haves:
  truths:
    - "Marketing layout has luxury editorial navigation with brand logo, page links, and invite CTA"
    - "Navigation is transparent on hero, becomes solid on scroll (glassmorphism effect)"
    - "Footer exists with brand identity, philosophy links, and legal text"
    - "Invite code entry page exists at /invite with form validation and luxury styling"
    - "Navigation links to Philosophy (/philosophy), Privacy (/privacy), and Invite (/invite)"
  artifacts:
    - path: "src/components/marketing/MarketingNav.tsx"
      provides: "Luxury editorial navigation with scroll-aware styling"
      min_lines: 80
    - path: "src/components/marketing/MarketingFooter.tsx"
      provides: "Editorial footer with brand identity"
      min_lines: 40
    - path: "src/app/(marketing)/layout.tsx"
      provides: "Updated marketing layout with nav and footer"
      min_lines: 15
    - path: "src/app/(marketing)/invite/page.tsx"
      provides: "Invite code entry form with validation"
      min_lines: 80
    - path: "src/app/api/invite/validate/route.ts"
      provides: "Invite code validation API endpoint (format-only stub, upgraded by 02-03)"
      min_lines: 15
  key_links:
    - from: "src/app/(marketing)/layout.tsx"
      to: "MarketingNav, MarketingFooter"
      via: "component import and render"
      pattern: "import.*MarketingNav|import.*MarketingFooter"
    - from: "src/components/marketing/MarketingNav.tsx"
      to: "/philosophy, /privacy, /invite"
      via: "Next.js Link components"
      pattern: "Link.*href.*philosophy|Link.*href.*privacy|Link.*href.*invite"
    - from: "src/app/(marketing)/invite/page.tsx"
      to: "zod validation"
      via: "form validation with react-hook-form + zodResolver"
      pattern: "zodResolver|useForm|inviteCode"
    - from: "src/app/(marketing)/invite/page.tsx"
      to: "src/app/api/invite/validate/route.ts"
      via: "fetch POST to validate invite code against backend"
      pattern: "fetch.*api/invite/validate"
---

<objective>
Create the marketing route group editorial layout with luxury navigation, footer, and invite code entry page.

Purpose: Establish the marketing shell that all editorial pages (homepage, philosophy, privacy) render within. The navigation must feel like Hermes or Cartier -- minimal, elegant, and intentional. The invite page is the gateway to the exclusive membership flow.

Output: Updated marketing layout with nav/footer components, invite code entry page at /invite with form validation.
</objective>

<execution_context>
@/Users/kavi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/kavi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-marketing-authentication/02-RESEARCH.md
@.planning/phases/01-foundation-design-system/01-03-SUMMARY.md

Key existing infrastructure:
- Marketing layout exists at src/app/(marketing)/layout.tsx (minimal, no nav, bg-white)
- Marketing homepage placeholder at src/app/(marketing)/page.tsx
- Shared components at src/components/shared/ (Button, Input, Card, etc.)
- cn() utility at src/lib/utils/cn.ts
- Animation variants at src/styles/variants/ (scroll-reveal, micro-interactions)
- Design tokens: rose (brand), sand (warm neutral), olive (text), teal (accent), gold (highlight)
- Fonts: font-serif (headings), font-sans (body) via src/app/fonts.ts
- Zod validation schemas at src/lib/types/validation.ts
- InviteCode entity type at src/lib/types/entities.ts
- react-hook-form + @hookform/resolvers already in package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create MarketingNav and MarketingFooter components</name>
  <files>
    src/components/marketing/MarketingNav.tsx
    src/components/marketing/MarketingFooter.tsx
    src/app/(marketing)/layout.tsx
  </files>
  <action>
    **MarketingNav.tsx** - Create a luxury editorial navigation component:

    1. 'use client' component (needs scroll detection + state)
    2. Use framer-motion `useScroll` and `useTransform` or `useMotionValueEvent` for scroll-aware styling
    3. **Initial state (top of page):** Transparent background, white text, no border -- floats over hero content
    4. **Scrolled state (past ~80px):** White background with `backdrop-blur-xl` glassmorphism, dark text, subtle bottom border `border-sand-200/50`
    5. **Fixed positioning:** `fixed top-0 left-0 right-0 z-50` with smooth transition between states (transition-colors duration-500)
    6. **Layout:** Flex row with:
       - Left: Brand wordmark "Elan Glimmora" in font-serif, tracking-widest, uppercase, text-sm -- link to /
       - Center: Nav links in font-sans, text-xs, tracking-[0.2em], uppercase, letter-spaced: "Philosophy" (/philosophy), "Privacy Charter" (/privacy)
       - Right: "Request Access" button linking to /invite -- use existing Button component with variant="ghost" styling, subtle border on hover
    7. **Mobile:** Hamburger menu icon (Lucide Menu icon), opens full-screen overlay with nav links centered vertically, close button top-right
    8. **Hover states:** Links have subtle opacity transition (opacity-70 hover:opacity-100), no underlines
    9. **Active link:** Use `usePathname()` to detect current route, show subtle bottom dot or full opacity
    10. Import `cn` from `@/lib/utils/cn` for conditional classes
    11. Import `useReducedMotion` for animation preferences
    12. Use `motion.nav` for the scroll transition (animate background/border smoothly)

    **IMPORTANT STYLING NOTES:**
    - NO hamburger animation complexity -- simple icon swap (Menu -> X)
    - Mobile overlay: bg-white, full screen, flex-col items-center justify-center, gap-8
    - Desktop nav: hidden on mobile (md:flex), hamburger hidden on desktop (md:hidden)
    - All text should use the luxury palette: rose-900 for dark mode text, sand-600 for secondary
    - The nav must feel editorially restrained -- NOT a SaaS navbar with dropdowns and bells

    **MarketingFooter.tsx** - Create an editorial footer:

    1. Server component (no interactivity needed)
    2. Full-width, bg-rose-950 (deep dark rose), text-white/70
    3. **Layout:** Three columns on desktop, stacked on mobile:
       - Left: Brand wordmark "Elan Glimmora" in font-serif + one-line tagline "Sovereign Lifestyle Intelligence"
       - Center: Links column -- Philosophy, Privacy Charter, Request Access
       - Right: Legal text -- "By invitation only. All rights reserved."
    4. Bottom bar: Copyright year, "Elan Glimmora" brand
    5. Subtle top border: border-t border-rose-800/30
    6. Generous padding: py-20 px-6 lg:px-16
    7. Text: font-sans text-xs tracking-wider uppercase for links, font-serif for brand

    **Update marketing layout.tsx:**
    1. Import and render MarketingNav above `<main>`
    2. Import and render MarketingFooter below `<main>`
    3. Keep `bg-white` and `min-h-screen`
    4. Add `pt-0` to main (nav is fixed, pages handle their own top padding)
  </action>
  <verify>
    Run `pnpm tsc --noEmit` to verify TypeScript compilation.
    Run `pnpm build` to verify production build succeeds.
    Verify MarketingNav.tsx exists and is > 80 lines.
    Verify MarketingFooter.tsx exists and is > 40 lines.
    Verify layout.tsx imports both components.
  </verify>
  <done>
    Marketing layout renders with fixed luxury navigation (transparent -> glassmorphism on scroll) and editorial footer. Nav links point to /philosophy, /privacy, and /invite. Mobile responsive with hamburger menu overlay.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create invite code entry page at /invite</name>
  <files>
    src/app/(marketing)/invite/page.tsx
    src/app/api/invite/validate/route.ts
  </files>
  <action>
    Create the invite code entry page and its backend validation API route.

    **API route: /api/invite/validate**
    File: `src/app/api/invite/validate/route.ts`
    - POST handler accepting `{ code: string }`
    - Validates invite code format against regex `/^ELAN-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}$/`
    - For now, returns `{ valid: true }` if format matches, `{ valid: false, error: 'Invalid invite code format' }` if not
    - This is a format-only stub. Plan 02-03 upgrades this route to call `validateInviteCode()` from `src/lib/auth/invite-codes.ts` for real backend validation (existence, expiry, usage limits).
    - Return appropriate HTTP status codes: 200 for valid, 400 for invalid format, 422 for invalid code

    **Invite code entry page:**
    Create the invite code entry page that serves as the gateway to exclusive membership.

    **Page structure:**
    1. 'use client' component (form state management)
    2. Full-screen layout with centered content
    3. **Background:** Subtle gradient from white to sand-50, or a minimal radial gradient centered
    4. **Content block:** max-w-md centered, generous spacing

    **Content flow:**
    1. **Header section:**
       - Small eyebrow text: "EXCLUSIVE MEMBERSHIP" in font-sans, text-xs, tracking-[0.3em], text-sand-500, uppercase
       - Main heading: "Enter Your Invitation" in font-serif, text-4xl md:text-5xl, text-rose-900
       - Subtext: "Elan Glimmora is available by invitation only. Enter your personal code to begin." in font-sans, text-base, text-sand-600, max-w-sm

    2. **Invite code form:**
       - Use `react-hook-form` with `zodResolver`
       - Create Zod schema for invite code validation:
         - inviteCode: z.string().min(1, 'Invite code is required').regex(/^ELAN-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}$/, 'Invalid invite code format')
       - Single input field for invite code:
         - Use existing Input component from shared components
         - Placeholder: "ELAN-XXXX-XXXX-XXXX"
         - Style: text-center, font-mono, tracking-widest, text-lg
         - Auto-format on input: uppercase, auto-insert dashes after every 4 chars
       - Submit button: "Verify Invitation" using existing Button component
         - Full width, bg-rose-900 text-white hover:bg-rose-800
         - Loading state with subtle animation
       - Error display below input for invalid codes (text-rose-600, text-sm)

    3. **Form submission:**
       - On submit, first validate format client-side (Zod regex), then call `POST /api/invite/validate` with `{ code }` to validate against the backend
       - The API route `/api/invite/validate` is created in this plan as a simple format-only stub (returns `{ valid: true }` if format matches). Plan 02-03 upgrades this route to call `validateInviteCode()` for real backend validation (checking existence, expiry, usage limits).
       - On success (API returns `{ valid: true }`): show a success state with message "Invitation verified. Preparing your experience..." and a "Continue" button that links to /invite/register (does NOT need to exist yet -- page will be created in Plan 02-03)
       - On failure (API returns `{ valid: false, error: string }`): show error message with shake animation using framer-motion
       - Store validated invite code in sessionStorage for use in registration flow

    4. **Bottom section:**
       - Small text: "Don't have an invitation? Contact your advisor." in text-sand-400, text-xs
       - NO public signup -- this is invite-only, no "sign up here" link

    5. **ScrollReveal animations:**
       - Wrap header, form, and bottom text in ScrollReveal for entrance animations
       - Use fadeUp variant with staggered delays (0, 0.1, 0.2)

    6. **Metadata:**
       - Export metadata: title "Request Access", description for SEO

    **STYLING RULES:**
    - The page must feel like receiving a physical invitation -- precious, exclusive
    - Generous whitespace, restrained typography, no visual clutter
    - Input styling: large, clean, monospaced code entry
    - Error states must be elegant (no jarring red boxes), use subtle rose-600 text
    - Success state: subtle check animation, transition to green-tinted message
  </action>
  <verify>
    Run `pnpm tsc --noEmit` to verify TypeScript compilation.
    Run `pnpm build` to verify production build succeeds.
    Verify invite/page.tsx exists at src/app/(marketing)/invite/page.tsx.
    Verify the file imports react-hook-form and zod.
    Verify the page is > 80 lines.
    Verify API route exists at src/app/api/invite/validate/route.ts.
    Verify the invite page calls `fetch('/api/invite/validate', ...)` on form submission.
  </verify>
  <done>
    Invite code entry page exists at /invite with luxury styling, invite code format validation (ELAN-XXXX-XXXX-XXXX), react-hook-form integration, error/success states, and ScrollReveal animations. The page calls POST /api/invite/validate to validate the code against a backend API route (format-only stub in this plan; upgraded to real backend validation by Plan 02-03). Valid codes are stored in sessionStorage for the registration flow.
  </done>
</task>

</tasks>

<verification>
1. `pnpm tsc --noEmit` passes with zero errors
2. `pnpm build` succeeds
3. MarketingNav renders in marketing layout with transparent-to-solid scroll behavior
4. MarketingFooter renders below main content
5. /invite route renders invite code entry form
6. Nav links point to /philosophy, /privacy, /invite
7. Mobile hamburger menu opens full-screen overlay
8. Invite code input validates ELAN-XXXX-XXXX-XXXX format
</verification>

<success_criteria>
- Marketing layout has luxury navigation and editorial footer
- Navigation is scroll-aware (transparent -> glassmorphism)
- Invite code entry page validates invite code format with luxury UX
- All routes compile and build successfully
- Mobile responsive navigation with hamburger menu
</success_criteria>

<output>
After completion, create `.planning/phases/02-marketing-authentication/02-01-SUMMARY.md`
</output>
